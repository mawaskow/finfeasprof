{% extends "base.html" %}

{% block title %}FFP Tool{% endblock %}
{% block content %}
<div class="textchunk" id="ffp_intro">
    <h4>
    The Financial Feasibility and Pricing Tool
    <img src="{{url_for('static', filename='FFP_logo.png')}}" width="70" height="55" class="d-inline-block align-text-center">
    <img src="{{url_for('static', filename='INSIGHT-LOGO.png')}}" width="105" height="35" class="d-inline-block align-text-center">
    </h4>
    <p>With this tool, you have the ability to calculate the expected financial feasibility and pricing of a rewetting scheme.</p>

    <h5>User Input</h5>

    <p>Default settings are populated into the below form.</p>
    <p>Change values if needed then press submit to update.</p>
</div>
<div class="container-fluid textchunk">
    <div class="row">
        <div class="col" id="input-form-div">
            <form action="/ffptool" method="POST" id="input-form" enctype=multipart/form-data>
                <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">

                <label for="num_yrs">Period of Years:</label>
                <input type="number" class="validate" id="num_yrs" name="num_yrs" value="{{uform['num_yrs']}}" min="0" max="9999" step="0.001" onkeyup="ffp_calculation()" required>
                <br>
                <label for="cred_p_hect_p_yr">Credits per Hectare per Year:</label>
                <input type="number" class="validate" id="cred_p_hect_p_yr" name="cred_p_hect_p_yr" value="{{uform['cred_p_hect_p_yr']}}" min="0" max="1000000000" step="0.001" onkeyup="ffp_calculation()" required>
                <br>
                <label for="hect_restored">Hectares Restored:</label>
                <input type="number" class="validate" id="hect_restored" name="hect_restored" value="{{uform['hect_restored']}}" min="0" max="1000000000" step="0.001" onkeyup="ffp_calculation()" required>
                <br>
                <label for="invest_amt">Investment Amount:</label>
                <input type="number" class="validate" id="invest_amt" name="invest_amt" value="{{uform['invest_amt']}}" min="0" max="1000000000" step="0.001" onkeyup="ffp_calculation()" required>
                <br>
                <label for="start_yr">Start Year:</label>
                <input type="number" class="validate" id="start_yr" name="start_yr" value="{{uform['start_yr']}}" min="1900" max="3000" onkeyup="ffp_calculation()" required>
                <br>
                <label for="price_p_cred">Price per Credit:</label>
                <input type="number" class="validate" id="price_p_cred" name="price_p_cred" value="{{uform['price_p_cred']}}" min="0" max="1000000000" step="0.001" onkeyup="ffp_calculation()" required>
                <br>
                {% if uform['invest_costs_inc'] %}
                    <label for="invest_costs_inc">Include Investment Costs:</label>
                    <input type="checkbox" id="invest_costs_inc" name="invest_costs_inc" value="{{uform['invest_costs_inc']}}" onclick="ffp_calculation()" checked>
                    <br>
                {% else %}
                    <label for="invest_costs_inc">Include Investment Costs:</label>
                    <input type="checkbox" id="invest_costs_inc" name="invest_costs_inc" value="{{uform['invest_costs_inc']}}" onclick="ffp_calculation()">
                    <br>
                {% endif %}
                {% if uform['reg_costs_inc'] %}
                    <label for="reg_costs_inc">Include Registration Costs:</label>
                    <input type="checkbox" id="reg_costs_inc" name="reg_costs_inc" value="{{uform['reg_costs_inc']}}" onclick="ffp_calculation()" checked>
                    <br>
                {% else %}
                    <label for="reg_costs_inc">Include Registration Costs:</label>
                    <input type="checkbox" id="reg_costs_inc" name="reg_costs_inc" value="{{uform['reg_costs_inc']}}" onclick="ffp_calculation()">
                    <br>
                {% endif %}
            </form>
        </div>

        <div class="col" style="display: inline;" id="results">
            <h5>Results</h5>
            <p>
                <span>Profitable?: </span><span id="is_prof">{{results_dict["profitable"]}}</span>
            </p>
            <p>
                <span>Profit per credit: </span><span id="prof_p_cred">{{results_dict["profit_per_credit"]}}</span>
            </p>
            <p>
                <span>Profit per hectare per year: </span><span id="prof_phpy">{{results_dict["profit_per_hectare_per_year"]}}</span>
            </p>
            <p>
                <span>Beginning Value: </span><span id="beg_val">{{results_dict["beginning_value"]}}</span>
            </p>
            <p>
                <span>Ending Value: </span><span id="end_val">{{results_dict["ending_value_undisc"]}}</span>
            </p>
            <p>
                <span>Rate of Return: </span><span id="rate_ret">{{results_dict["rate_of_return"]}}</span>
            </p>
        </div>
    </div>
</div>

<div class="textchunk">
<label for="assum_disp_btn">To Edit Assumptions: </label>
<!--<button onclick="toggle_display()" id="assum_disp_btn">Assumptions</button>-->
<button id="assum_disp_btn">Assumptions</button>
</div>

<div class="content_section textchunk" id="assum-form-div" style="display:none">
    <h5>Model Assumptions</h5>

    <p>Default settings are populated into the below form.</p>
    <p>Change values if needed then press submit to update.</p>
    <form action="/ffptool" method="POST" id="assum-form" enctype=multipart/form-data>
        <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">

        <label for="nom_int_rt">Nominal Interest Rate:</label>
        <input type="number" class="validate" id="nom_int_rt" name="nom_int_rt" value="{{aform['nom_int_rt']}}" min="0" max="0.999999" step="0.000001" onkeyup="ffp_calculation()" required>
        <br>
        <label for="inflation_rt">Inflation Rate:</label>
        <input type="number" class="validate" id="inflation_rt" name="inflation_rt" value="{{aform['inflation_rt']}}" min="0" max="0.999999" step="0.000001" onkeyup="ffp_calculation()" required>
        <br>
        <label for="reg_acct_open_fee">Registry Account Opening Fee:</label>
        <input type="number" class="validate" id="reg_acct_open_fee" name="reg_acct_open_fee" value="{{aform['reg_acct_open_fee']}}" min="0" max="1000000000" step="0.001" onkeyup="ffp_calculation()" required>
        <br>
        <label for="reg_listing_cost_p_credit">Registry Listing Cost per Credit:</label>
        <input type="number" class="validate" id="reg_listing_cost_p_credit" name="reg_listing_cost_p_credit" value="{{aform['reg_listing_cost_p_credit']}}" min="0" max="1000000000" step="0.001" onkeyup="ffp_calculation()" required>
        <br>
        <label for="reg_conv_cost_fee_p_inspect">Registry Conversion Cost Fee per Inspection:</label>
        <input type="number" class="validate" id="reg_conv_cost_fee_p_inspect" name="reg_conv_cost_fee_p_inspect" value="{{aform['reg_conv_cost_fee_p_inspect']}}" min="0" max="1000000000" step="0.001" onkeyup="ffp_calculation()" required>
        <br>
        <label for="reg_conv_cost_p_cred_abv_min_thresh_of_credits">Registry Conversion Cost per Credit above Minimum Threshold of Credits:</label>
        <input type="number" class="validate" id="reg_conv_cost_p_cred_abv_min_thresh_of_credits" name="reg_conv_cost_p_cred_abv_min_thresh_of_credits" value="{{aform['reg_conv_cost_p_cred_abv_min_thresh_of_credits']}}" min="0" max="0.999999" step="0.000001" onkeyup="ffp_calculation()" required>
        <br>
        <label for="reg_levy_cost_p_cred">Registry Levy Cost per Credit:</label>
        <input type="number" class="validate" id="reg_levy_cost_p_cred" name="reg_levy_cost_p_cred" value="{{aform['reg_levy_cost_p_cred']}}" min="0" max="0.999999" step="0.000001" onkeyup="ffp_calculation()" required>
        <br>
        <label for="valid_and_verif_app_cost_p_inspect">Validation and Verification Application Cost per Inspection:</label>
        <input type="number" class="validate" id="valid_and_verif_app_cost_p_inspect" name="valid_and_verif_app_cost_p_inspect" value="{{aform['valid_and_verif_app_cost_p_inspect']}}" min="0" max="1000000000" step="0.001" onkeyup="ffp_calculation()" required>
        <br>
        <label for="valid_and_verif_stmnt_cost_p_inspect">Validation and Verification Statement Cost per Inspection:</label>
        <input type="number" class="validate" id="valid_and_verif_stmnt_cost_p_inspect" name="valid_and_verif_stmnt_cost_p_inspect" value="{{aform['valid_and_verif_stmnt_cost_p_inspect']}}" min="0" max="1000000000" step="0.001" onkeyup="ffp_calculation()" required>
        <br>
        <label for="valid_and_verif_inspctr_travel_cost_p_inspect">Validation and Verification Inspector Travel Costs per Inspection:</label>
        <input type="number" class="validate" id="valid_and_verif_inspctr_travel_cost_p_inspect" name="valid_and_verif_inspctr_travel_cost_p_inspect" value="{{aform['valid_and_verif_inspctr_travel_cost_p_inspect']}}" min="0" max="1000000000" step="0.001" onkeyup="ffp_calculation()" required>
        <br>
        <label for="inspect_cycle_len">Inspection Cycle Length:</label>
        <input type="number" class="validate" id="inspect_cycle_len" name="inspect_cycle_len" value="{{aform['inspect_cycle_len']}}" min="0" max="1000000000" step="0.001" onkeyup="ffp_calculation()" required>
        <br>
        <label for="min_thresh_of_credits">Minimum Threshold of Credits:</label>
        <input type="number" class="validate" id="min_thresh_of_credits" name="min_thresh_of_credits" value="{{aform['min_thresh_of_credits']}}" min="0" max="1000000000" step="0.001" onkeyup="ffp_calculation()" required>
        <br>
        <label for="interest_rt">Interest Rate:</label>
        <input type="number" class="validate" id="interest_rt" name="interest_rt" value="{{aform['interest_rt']}}" min="0" max="0.999999" step="0.000001" onkeyup="ffp_calculation()" required>
        <br>
        <label for="payments_p_yr">Payments per Year:</label>
        <input type="number" class="validate" id="payments_p_yr" name="payments_p_yr" value="{{aform['payments_p_yr']}}" min="0" max="1000" step="0.001" onkeyup="ffp_calculation()" required>
        <br>
    </form>
</div>

{% endblock %}